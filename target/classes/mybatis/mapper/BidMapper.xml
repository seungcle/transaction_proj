<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="subak.example.subak.dao.BidDAO">
	<select id="findBidsByItemId" parameterType="long" resultType="BidResponseVO">
        SELECT
            b.id,
            b.bid_item_id AS bidItemId,
            b.bid_price   AS bidPrice,
            u.nickname,
            u.image_url   AS imageUrl,
            TO_CHAR(b.created_at, 'YYYY-MM-DD HH24:MI:SS') AS createdAt
        FROM
            bid b
        INNER JOIN
            "user" u ON b.bid_user_id = u.id
        WHERE
            b.bid_item_id = #{itemId}
        ORDER BY
            b.bid_price DESC
    </select>
    <select id="countBidsByItemId" parameterType="long" resultType="int">
        SELECT
            COUNT(*)
        FROM
            bid
        WHERE
            bid_item_id = #{itemId}
    </select>
</mapper>
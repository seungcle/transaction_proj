<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="subak.example.subak.dao.UserDAO">
	<!-- 회원가입 -->
	<insert id="insertUser" parameterType="UserDTO">
		insert into "user" (username, password, email, nickname, created_at)
		values (#{username}, #{password}, #{email}, #{nickname}, sysdate)
	</insert>

	<!-- 아이디 중복 체크 -->
	<select id="checkUsername" parameterType="string"
		resultType="int">
		select count(*)
		from "user"
		where username = #{username}
	</select>

	<!-- 닉네임 중복 체크 -->
	<select id="checkNickname" parameterType="string"
		resultType="int">
		SELECT COUNT(*) FROM "user"
		WHERE nickname = #{nickname}
	</select>

	<!-- 로그인 -->
	<select id="login" parameterType="LoginRequestDTO"
		resultType="SessionUserVO">
		select id, username, email, nickname
		from "user"
		where username = #{username} and password = #{password}
	</select>

	<!-- 내 마이페이지 -->
	<select id="findById" parameterType="long"
		resultType="UserInfoVO">
		select nickname, bio, image_url
		from "user"
		where id = #{id}
	</select>

	<!-- 비밀번호 확인 -->
	<select id="getPasswordByUserId" resultType="String">
		SELECT password FROM user WHERE id = #{id}
	</select>
</mapper>








